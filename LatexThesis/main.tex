% \documentclass[12pt]{report}
\documentclass[11pt,table,xcdraw]{report}

% Fonts
% Greek font
% \usepackage[T1]{fontenc} %% LGR encoding is needed for loading the package gfsneohellenic
% \usepackage[default]{gfsneohellenic}

% Sans serif font
% \usepackage[T1]{fontenc}
% \usepackage{sansmathfonts}
% \renewcommand*\familydefault{\sfdefault} %% Only if the base font of the document is to be sans serif
% \usepackage{lmodern}
% \usepackage{fix-cm}

% TeX Gyre Pagella
\usepackage[T1]{fontenc}
\usepackage{tgpagella}
\usepackage[scaled]{beramono}
% \usepackage{palatino}
% \renewcommand*\familydefault{\sfdefault} %% Only if the base font of the document is to be sans serif
\usepackage{fix-cm}

% Reduce space before chapter title
\usepackage{titlesec}
\titleformat{\chapter}[display]
{\normalfont\huge\bfseries}{\chaptertitlename\ \thechapter}{20pt}{\Huge}
\titlespacing*{\chapter}{0pt}{0pt}{20pt}

% Packages
\usepackage{graphicx}
\usepackage{float}
\usepackage{mathalpha}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{multicol}
\usepackage{multirow}
\usepackage[super]{nth}
\usepackage{subcaption}
\usepackage[export]{adjustbox}
\usepackage{pdfpages}
\usepackage{stackengine}
\usepackage{booktabs}
\usepackage{adjustbox} 
\usepackage{tabularx}
\usepackage{array}
\usepackage{wrapfig}
\usepackage{rotating}
% TABLES
\usepackage{xcolor}
\usepackage[normalem]{ulem}
\useunder{\uline}{\ul}{}
\definecolor{llgray}{gray}{0.98}

% Listing in Lisp
\usepackage{listings}
\lstset{
    numbers=left,
    numberstyle=\tiny,
    numbersep=9pt,
    language=Lisp,
    % stringstyle=\ttfamily\small,
    stringstyle=\ttfamily\footnotesize,
    basicstyle=\ttfamily\footnotesize,
    % basicstyle=\ttfamily\scriptsize,
    showstringspaces=false,
    breaklines=true,
    frame=single,
    keywordstyle=\color{purple},
    commentstyle=\color{darkgray},
    backgroundcolor=\color{llgray},
    morekeywords = {gil, om, for, if, setq}
}
% Captions package
\usepackage[hypcap=false]{caption}
\DeclareCaptionType{trans}[Transcription][List of transcriptions]
% Bibliography package
\usepackage[
    backend=bibtex,
    %backend=biber,
    sorting=none
    % style=authoryear-icomp
]{biblatex}

% Others
\newenvironment{Figure}
  {\par\medskip\noindent\minipage{\linewidth}}
  {\endminipage\par\medskip}

% External files
% \usepackage{xr}
% \externaldocument{Sections/sct_1SP}

% New commands
% TODO counter
\newcounter{todocount}
\newcounter{todosecc}
\newcounter{todoimac}
\setcounter{todocount}{0}
\setcounter{todosecc}{0}
\setcounter{todoimac}{0}
\newcommand{\todo}{\stepcounter{todocount}\textbf{\textcolor{magenta}{TODO \arabic{todocount} }}}
\newcommand{\todosec}{\stepcounter{todosecc}\textbf{\textcolor{blue}{TODO-sec \arabic{todosecc} }}}
\newcommand{\todoimage}{\stepcounter{todoimac}\textbf{\textcolor{red}{TODO-fig \arabic{todoimac} }}}
% shortcut for cantus firmus in italic font
\newcommand{\gap}{\textit{Gradus ad Parnassum}}
\newcommand{\gaps}{\textit{Gradus ad Parnassum }}
\newcommand{\cf}{\textit{cantus firmus}}
\newcommand{\cfs}{\textit{cantus firmus }}
\newcommand{\cp}{counterpoint}
\newcommand{\cps}{counterpoint }
\newcommand{\cfdot}{\textit{cantus firmus. }}
\newcommand{\cpdot}{counterpoint.}
\newcommand{\cfcomma}{\textit{cantus firmus, }}
% shortcut for species
\newcommand{\species}[1]{\nth{#1} species}
% shortcut for B in mathcal
\newcommand{\B}{\mathcal{B}}
% shortcut for N in mathcal
\newcommand{\N}{\mathcal{N}}
% shortcut for R in mathcal
\newcommand{\R}{\mathcal{R}}
% \newcommand{\R}{R}
% shortcut for C in mathcal
\newcommand{\C}{\mathcal{C}}
% shortcut for I in mathcal
\newcommand{\I}{\mathcal{I}}
% shortcut for Lisp ID
\newcommand{\lid}[1]{$\lambda$ID = \texttt{#1}}
% shortcut for default value
\newcommand{\df}[1]{\qquad \textit{DFLT: <#1>}}
\newcommand{\dft}[1]{\textit{DFLT: <#1>}}
\newcommand{\dfts}[1]{\textit{<#1>}}
% shortcut for forall values
\newcommand{\forj}{\forall j \in [0, m-1)}
\newcommand{\forn}{\forall i \in \B, \forall j \in [0, m)}
\newcommand{\fornm}{\forall i \in \B, \forall j \in [0, m-1)}
\newcommand{\fornmm}{\forall i \in \B, \forall j \in [0, m-2)}
\newcommand{\forp}{\forall \rho \in positions(m)}
\newcommand{\forpm}{\forall \rho \in positions(m-1)}
\newcommand{\forpmm}{\forall \rho \in positions(m-2)}
% size used for the height of figures
\newcommand{\fhs}{1.1in}
\newcommand{\fh}{1.2in}
\newcommand{\fhl}{1.3in}
\definecolor{darkred}{RGB}{139, 0, 0}
\newcommand{\reddot}{\textcolor{red}{\textbullet}}
\newcommand{\reddots}{\textcolor{red}{\textbullet} }
\newcommand{\greendot}{\textcolor{green}{\textbullet}}
\newcommand{\greendots}{\textcolor{green}{\textbullet} }


% auto cite from bib
\DeclareCiteCommand{\citea}
{\boolfalse{citetracker}\boolfalse{pagetracker}\usebibmacro{prenote}}
{\href{\thefield{url}}{here}}
{\multicitedelim}
{\usebibmacro{postnote}}
% add "Score available here." sending to url + reference beside
\newcommand{\listen}[1]{Score available \citea{#1} \parencite{#1}}
% add "Listen here." sending to url + reference beside
\newcommand{\listenyt}[1]{and listen \href{#1}{here} \parencite{EvalYT}.}

% Load Bibliography
\addbibresource{Bibliography/cite.bib}

\title{Formalizing Fux's Theory of Musical Counterpoint Using Constraint Programming}
\author{Anton Lamotte}
\date{January 2024}

% Document settings
% \usepackage[margin=1.3in]{geometry}
\usepackage{geometry}
\geometry{
    a4paper,
    % total={170mm,257mm},
    left=1.3in,
    right=1.3in,
    top=1in,
    bottom=1in,
}

\begin{document}
\pagenumbering{roman}
%\maketitle
\includepdf[pages=1]{FrontPage.pdf}
\null
\thispagestyle{empty}
\addtocounter{page}{-1}
\newpage
\newgeometry{left=1.65in,right=1.65in,top=2in,bottom=2in}
\begin{abstract}
    \large{
        This thesis presents a formalisation of three-part musical counterpoint according to the classical theory of Fux. This thesis is an extension of Thibault Wafflard's previous thesis, which formalised two-part counterpoint and implemented it in FuxCP, a software tool designed specifically for composers to help them compose counterpoint without the need for technical expertise. Counterpoint consists of several musical voices that are independent and distinct from each other, yet balanced and beautiful in sound. It consists of a fixed part, the \cf, and one or more parts derived from it. Three-part counterpoint therefore consists of one \cf and two counterpoints. This is much more expressive than two-part counterpoint because of the interactions between the two derived parts.
        FuxCP is implemented in OpenMusic, a musical interface, and uses Gecode, a well-known constraint solver, to automatically generate counterpoints. The implementation is based on Johann Joseph Fux's \gap, a seminal treatise on counterpoint published in 1725, by translating the rules of this treatise into formal logic and implementing them as constraints. In particular, the extension to three voices places special emphasis on the lowest voice, introducing innovative concepts and variables to address this key aspect.
        This work contributes to the research and understanding of automated contrapuntal composition by overcoming the challenge of generalising the interaction between voices. It also addresses preferences, which are treated as optional rules, introducing nuance into the generation of musical solutions and enhancing the overall aesthetic considerations in automated counterpoint composition. Importantly, this work builds seamlessly on T. Wafflard's previous efforts, ensuring full compatibility with his thesis.   }
\end{abstract}

\chapter*{Acknowledgements}
\dots
%\paragraph{Thanks to Zou} for reminding me to write those acknowledgements.
%\paragraph{Thanks to Alex} for her good metaphors. Only the good ones.
\restoregeometry 

\tableofcontents

\input{Sections/sct_Introduction.tex}
\input{Sections/sct_Redefinitions.tex}
\input{Sections/sct_Species.tex}
\input{Sections/sct_Search.tex}
\input{Sections/sct_Musicality.tex}
\input{Sections/sct_Conclusion.tex}
\addcontentsline{toc}{chapter}{Bibliography}
\printbibliography

%\bibliographystyle{plain}
%\bibliography{Bibliography/cite}
\appendix
\input{Appendix/app_Architecture.tex}
\input{Appendix/app_User_guide.tex}
\input{Appendix/app_All_rules.tex}
\input{Appendix/app_Code.tex}

%add all translations, gecode, gil, t.Wafflard's thesis AND article, Bitsch, 

\includepdf[pages=1]{BackPage.pdf}
\end{document}